{% extends 'destinations/base.html' %}
{% load static i18n %}
{% block title %}{% trans 'Create Social network' %}{% endblock %}

{%block css%}
{{ block.super }}
{{ form.media.css }}
<link href="{% static "inspinia/js/plugins/select2/select2.min.css" %}" rel="stylesheet">
<link href="{% static "inspinia/js/plugins/dataTables/datatables.min.css" %}" rel="stylesheet">
<link href="{% static "inspinia/js/plugins/toastr/toastr.min.css" %}" rel="stylesheet">
<link href="{% static "inspinia/js/plugins/sweetalert/sweetalert.css" %}" rel="stylesheet">
{%endblock css%}

{% block content %}
  <div id="page-wrapper" class="gray-bg">
    {% include 'destinations/navbar_top.html' %}

    <div class="wrapper wrapper-content animated fadeInRight">
      <div class="p-w-md m-t-sm">
        <div class="row">
                {% if errors %}
                    <span class="badge badge-danger">{{ errors }}</span>
                {% endif %}
            <div class="ibox">
                <div class="ibox-title">
                    <button type="button" class="btn btn-primary pull-right" data-toggle="modal" data-target="#socialModal">{% trans "New Social Network configuration"%}</button>
                </div>
              <div class="ibox-content">
                <div class="row">
                  <div class="col-md-12 mt-4">
                    <div class="table-responsive">
                      <table id ="table-itinerary" class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th data-filter="false"></th>
                                    <th>{% trans "Destination's name"%}</th>
                                    <th>{% trans "Status"%}</th>
                                    <th data-filter="true"></th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for row in add %}
                                    <tr>
                                        <th>{{ forloop.counter }}</th>

                                        <th>
                                            {{ row.destination }}
                                        </th>
                                        <th>
                                            <i class="fa fa-check-circle"></i> 
                                        </th>

                                        <th>
                                            <span class="btn btn-success btn-sm"><a href="{% url 'destinations:update-social' row.pk %}" style="color: #fff;"><i class="fa fa-lg fa-edit"></i>{% trans "Edit" %}</a></span>
                                            <span class="btn btn-danger btn-sm" onClick="delete_setting({{ row.id }})"><i class="fa fa-lg fa-trash "></i>{% trans "Delete" %}</span>
                                        </th>
                                    </tr>
                                {% endfor%}
                            </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            {% include 'destinations/social_modal.html' %}


          </div>
        </div>
      </div>
    </div>
    {% include 'destinations/footer.html' %}
  </div>
{% endblock %}


{% block js %}
  {{ block.super }}
  {{ form.media.js }}
    <script src="{% static "inspinia/js/plugins/dataTables/datatables.min.js" %}"></script>
    <script src="{% static "inspinia/js/plugins/dataTables/dataTables.bootstrap4.min.js"%}"></script>
    <script src="{% static "inspinia/js/plugins/select2/select2.full.min.js" %}"></script>
    <script src="{% static "inspinia/js/plugins/toastr/toastr.min.js" %}"></script>
    <script src="{% static "inspinia/js/plugins/sweetalert/sweetalert.min.js" %}"></script>
    <script src="{% static "inspinia/js/notifications.js" %}"></script>
  <script>
    //Delete fuction
    function delete_setting(pk_i){
          swal({
              title: "{% trans "Are you sure?" %}",
              text: "{% trans "If you delete this configuration you will not be able to recover it" %}",
              type: "warning",
              showCancelButton: true,
              confirmButtonColor: "#DD6B55",
              confirmButtonText: "{% trans "Yes, delete it!" %}",
              closeOnConfirm: false
          }, function () {
            $.ajax({
                  method:'DELETE',
                  url:'{% url 'destinations:delete-setting' %}',
                  data:{
                    pk:pk_i,
                  },
                  beforeSend: function(xhr) {
                      xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
                  },
                  success: function (request) {
                  if(request.status==true){
                    swal("Deleted!", "This configuration has been deleted.", "success");
                    setTimeout(function(){
                        window.location.href = "{% url 'destinations:social-network' %}";
                    }, 2000);
                  }else{
                      swal("Error!", "{% trans "Has been not deleted"%}", "error");
                  }
                  }
              });
          });
    }    
    </script>

{% endblock %}
