

{% extends "base.html" %}
{% load cms_tags i18n menu_tags sekizai_tags staticfiles destinations_tags humanize %}
{% block title %}{% trans 'Categories' %}{% endblock title %}
{% block navbar %}
{% include 'menu/navbar_all.html' %}
{% endblock navbar %}
{% block extracss %}
<link rel="stylesheet" href="{% static 'assets/vendor/bootstrap-select/dist/css/bootstrap-select.min.css' %}">
<link rel="stylesheet" href="{% static 'assets/vendor/ion-rangeslider/css/ion.rangeSlider.css' %}">
<link rel="stylesheet" href="{% static 'assets/vendor/MixitUpV3/dist/mixtup.css' %}">
{% endblock extracss %}
{% block content %}
{% if all_categories %}
<div id="SVGHero" class="position-relative bg-img-hero" style="background-image: url({% static 'img/trains.jpg' %});">
    <div class="container space-top-2 space-bottom-3 space-md-3 space-bottom-lg-4">
        <div class="w-md-65 w-lg-50">
            <h1 class="h1 " style="color: rgba(255, 255, 255, 0.925);">{% trans "You'll have an excellent trip." %}</h1>
            <h2 class="h1 text-primary font-weight-medium">{% trans "Meet our best destinations" %}</h2>
        </div>
    </div>
    <!-- SVG Background -->
    <figure class="position-absolute right-0 bottom-0 left-0">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="none" x="0px" y="0px" width="100%" height="85px" viewBox="0 0 1920 107.7" style="margin-bottom: -8px; enable-background:new 0 0 1920 107.7;" xml:space="preserve" class="injected-svg js-svg-injector" data-parent="#SVGHero">
            <style type="text/css">
                .wave-9-bottom-0{fill:#FFFFFF;}
                .wave-9-bottom-1{fill:#FFFFFF;}
            </style>
            <path class="wave-9-bottom-0 fill-white" d="M0,107.7V69.8c0,0,451-54.7,960-5.4S1920,0,1920,0v107.7H0z"></path>
            <path class="wave-9-bottom-1 fill-white" opacity=".3" d="M0,107.7v-81c0,0,316.2-8.9,646.1,54.5s794.7-114.1,1273.9-38v64.5H0z"></path>
        </svg>
    </figure>
    <!-- End SVG Background -->
</div>
{% else %}
<div id="SVGHero" class="position-relative bg-img-hero" style="background-image: url(/main/media/{{ categorie.first.image }});">
    <div class="container space-top-2 space-bottom-3 space-md-3 space-bottom-lg-4">
        <div class="w-md-65 w-lg-50">
            <h1 class="h1" style="color: rgba(255, 255, 255, 0.925);">{{ categorie.first.name }}</h1>
            <h2 class="h1 text-primary">{{ categorie.first.short_description }}</h2>
        </div>
    </div>
    <!-- SVG Background -->
    <figure class="position-absolute right-0 bottom-0 left-0">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="none" x="0px" y="0px" width="100%" height="85px" viewBox="0 0 1920 107.7" style="margin-bottom: -8px; enable-background:new 0 0 1920 107.7;" xml:space="preserve" class="injected-svg js-svg-injector" data-parent="#SVGHero">
            <style type="text/css">
                .wave-9-bottom-0{fill:#FFFFFF;}
                .wave-9-bottom-1{fill:#FFFFFF;}
            </style>
            <path class="wave-9-bottom-0 fill-white" d="M0,107.7V69.8c0,0,451-54.7,960-5.4S1920,0,1920,0v107.7H0z"></path>
            <path class="wave-9-bottom-1 fill-white" opacity=".3" d="M0,107.7v-81c0,0,316.2-8.9,646.1,54.5s794.7-114.1,1273.9-38v64.5H0z"></path>
        </svg>
    </figure>
    <!-- End SVG Background -->
</div>
{% endif %}
<br>
<!-- Categories & Filters Section -->
<div class="container space-1 space-md-1 space-lg-1 space-bottom-lg-3">
    <div class="row">
        <!-- Sorting -->
        {%include "services/destination/_parts/filter_destinations.html"%}

        <div class="col-lg-12">
            <!--Destinies -->
            <div id="list-destinies" class="row mx-n2 mb-2">
                {%include "services/destination/_parts/list_destinies.html"%}  
            </div>
            <!-- End Destinies -->
            <!-- Divider -->
            <div class="d-lg-none">
                <hr class="my-11">
            </div>
            <!-- End Divider -->
        </div>
        <!-- End Sorting -->
        <div class="py-3"></div>
        &nbsp;&nbsp;&nbsp;&nbsp;
        {%include "services/destination/_parts/pagination_destinies.html"%}  
        <input type="hidden" class="column-counter"/>

    </div>
</div>
<!-- End Products & Filters Section -->
{% endblock content %}
{% block extrajs %}
<script src="{% static 'assets/vendor/bootstrap-select/dist/js/bootstrap-select.min.js' %}"></script>
<script src="{% static 'assets/vendor/ion-rangeslider/js/ion.rangeSlider.min.js' %}"></script>
<script src="{% static 'assets/js/components/hs.selectpicker.js' %}"></script>
<script src="{% static 'assets/js/components/hs.range-slider.js' %}"></script>
<script src="{% static 'assets/vendor/MixitUpV3/dist/mixitup.min.js' %}"></script>
<script src="{% static 'assets/vendor/MixItUp/dist/mixitup-pagination.min.js' %}"></script>
<script>
    $.HSCore.components.HSRangeSlider.init('.js-range-slider');
    $.HSCore.components.HSSelectPicker.init('.js-select');
              var $filterSelect = $('#FilterDestinies');
              var containerEl = document.querySelector('#list-destinies');
              var mixer = mixitup(containerEl, {
                    pagination: {
                        limit: 8,
                        loop: true,
                        maintainActivePage: false,
                        hidePageListIfSinglePage: true
                    },
                    animation: {
                        nudge: false
                    },
                    callbacks: {
                        onMixStart: state => {

                        }
                    }
              });
              //
              $filterSelect.on('change', function(){
                  if(this.value=='all')
                    mixer.filter(this.value);
                  else
                    mixer.sort(this.value);
              });

              $("#filter_with_price").on('click', function(event) {
                event.preventDefault();
                var collection = Array.from(containerEl.querySelectorAll('.mix'));
                // Filter the collection manually
                var filtered = collection.filter(function(target) {
                        return parseFloat(target.getAttribute('data-price')) >= $("#rangeSliderMinPrice").val() && parseFloat(target.getAttribute('data-price')) <= $("#rangeSliderMaxPrice").val();
                });
                // console.log(filtered.length);
                // Pass the filtered collection to MixItUp
                mixer.filter(filtered)
                     .then(function(state) {
                            //console.log(state.activeFilter.collection.length); // 22
                     });
              });


</script>
{% endblock extrajs %}
